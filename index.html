<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Spatially Discrete Approximation to Log-Gaussian Cox Processes for Aggregated Disease Count Data • SDALGCP</title>
<script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="deps/headroom-0.11.0/headroom.min.js"></script><script src="deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="deps/search-1.0.0/fuse.min.js"></script><script src="deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="Spatially Discrete Approximation to Log-Gaussian Cox Processes for Aggregated Disease Count Data">
<meta name="description" content="Implements a computationally efficient approximation to a log-Gaussian Cox process model for spatially aggregated disease count data. The method uses Monte Carlo Maximum Likelihood estimation as described by Christensen (2004, doi:10.1198/106186004X2525) and supports both spatial and spatio-temporal data. The package enables prediction of relative risk on spatially discrete and continuous domains. See Johnson et al. (2019, doi:10.1002/sim.8339) for full methodological details.">
<meta property="og:description" content="Implements a computationally efficient approximation to a log-Gaussian Cox process model for spatially aggregated disease count data. The method uses Monte Carlo Maximum Likelihood estimation as described by Christensen (2004, doi:10.1198/106186004X2525) and supports both spatial and spatio-temporal data. The package enables prediction of relative risk on spatially discrete and continuous domains. See Johnson et al. (2019, doi:10.1002/sim.8339) for full methodological details.">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="index.html">SDALGCP</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.5.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="articles/SDALGCP-vignette.html">A Spatially Discrete Approximation to Log-Gaussian Cox Processes for Modelling Aggregated Disease Count Data</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/olatunjijohnson/SDALGCP/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-home">
<div class="row">
  <main id="main" class="col-md-9"><div class="section level1">
<div class="page-header"><h1 id="sdalgcp">SDALGCP<a class="anchor" aria-label="anchor" href="#sdalgcp"></a>
</h1></div>
<p>SDALGCP provides a computationally efficient discrete approximation to log-Gaussian Cox process (LGCP) model for spatially aggregated disease count data. It uses Monte Carlo Maximum Likelihood for model parameter estimation and delivers prediction of spatially discrete and continuous relative risk.</p>
</div>
<div class="section level1">
<h1 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h1>
<p>To install the latest development of SDALGCP package use</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">devtools</span><span class="fu">::</span><span class="fu">install_github</span><span class="op">(</span><span class="st">"olatunjijohnson/SDALGCP"</span><span class="op">)</span></span></code></pre></div>
<!-- SDALGCP provides an option to make parallel some matrix computation but the package that allows for this is not yet on cran. To install the parallel version of SDALGCP, install first the bigstatr from github -->
<!-- ```{r, eval=FALSE} -->
<!-- devtools::install_github("privefl/bigstatsr") -->
<!-- ``` -->
<!-- Then install SDALGCP from the branch using  -->
<!-- ```{r, eval=FALSE} -->
<!-- devtools::install_github("olatunjijohnson/SDALGCP#SDALGCPParallel") -->
<!-- ``` -->
</div>
<div class="section level1">
<h1 id="example">Example<a class="anchor" aria-label="anchor" href="#example"></a>
</h1>
<p>Here I present an illustrative example of how to use the package</p>
<p>load the package</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">require</a></span><span class="op">(</span><span class="va"><a href="https://github.com/olatunjijohnson/SDALGCP" class="external-link">SDALGCP</a></span><span class="op">)</span></span></code></pre></div>
<p>load the data</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"PBCshp"</span><span class="op">)</span></span></code></pre></div>
<p>extract the dataframe containing data from the object loaded</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="va">PBCshp</span><span class="op">@</span><span class="va">data</span><span class="op">)</span></span></code></pre></div>
<p>load the population density raster</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"pop_den"</span><span class="op">)</span></span></code></pre></div>
<p>set any population density that is NA to zero</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pop_den</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">pop_den</span><span class="op">[</span><span class="op">]</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">0</span></span></code></pre></div>
<p>write a formula of the model you want to fit</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">FORM</span> <span class="op">&lt;-</span> <span class="va">X</span> <span class="op">~</span> <span class="va">propmale</span> <span class="op">+</span> <span class="va">Income</span> <span class="op">+</span> <span class="va">Employment</span> <span class="op">+</span> <span class="va">Education</span> <span class="op">+</span> <span class="va">Barriers</span> <span class="op">+</span> <span class="va">Crime</span> <span class="op">+</span> </span>
<span>  <span class="va">Environment</span> <span class="op">+</span>  <span class="fu"><a href="https://rdrr.io/r/stats/offset.html" class="external-link">offset</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">pop</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>Now to proceed to fitting the model, note that there two types of model that can be fitted. One is when approximate the intensity of LGCP by taking the population weighted average and the other is by taking the simple average. We shall consider both cases in this tutorial, starting with population weighted since we have population density on a raster grid of 300m by 300m.</p>
<div class="section level2">
<h2 id="sdalgcp-i-population-weighted">SDALGCP I (population weighted)<a class="anchor" aria-label="anchor" href="#sdalgcp-i-population-weighted"></a>
</h2>
<p>Here we estimate the parameters of the model</p>
<p>Discretise the value of scale parameter <em>ϕ</em></p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">phi</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">500</span>, <span class="fl">1700</span>, length.out <span class="op">=</span> <span class="fl">20</span><span class="op">)</span></span></code></pre></div>
<p>estimate the parameter using MCML</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">my_est</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/SDALGCPMCML.html">SDALGCPMCML</a></span><span class="op">(</span>data<span class="op">=</span><span class="va">data</span>, formula<span class="op">=</span><span class="va">FORM</span>, my_shp<span class="op">=</span><span class="va">PBCshp</span>, delta<span class="op">=</span><span class="fl">300</span>, phi<span class="op">=</span><span class="va">phi</span>, method<span class="op">=</span><span class="fl">1</span>, pop_shp<span class="op">=</span><span class="va">pop_den</span>, </span>
<span>                      weighted<span class="op">=</span><span class="cn">TRUE</span>, par0<span class="op">=</span><span class="cn">NULL</span>, control.mcmc<span class="op">=</span><span class="cn">NULL</span>, messages <span class="op">=</span> <span class="cn">TRUE</span>, plot_profile <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p>To print the summary of the parameter estimates as well as the confidence interval, use;</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">my_est</span><span class="op">)</span></span>
<span><span class="co">#and for confidence interval use</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/confint.html" class="external-link">confint</a></span><span class="op">(</span><span class="va">my_est</span><span class="op">)</span></span></code></pre></div>
<p>We create a function to compute the confidence interval of the scale parameter using the deviance method. It also provides the deviance plot.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="reference/phiCI.html">phiCI</a></span><span class="op">(</span><span class="va">my_est</span>, coverage <span class="op">=</span> <span class="fl">0.95</span>, plot <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p>Having estimated the parameters of the model, one might be interested in area-level inference or spatially continuous inference.</p>
<ol style="list-style-type: decimal">
<li>If interested in STRICTLY area-level inference use the code below. This can either give either region-specific covariate-adjusted relative risk or region-specific incidence. This is achieved by simply setting in the function.</li>
</ol>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Dis_pred</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/SDALGCPPred.html">SDALGCPPred</a></span><span class="op">(</span>para_est<span class="op">=</span><span class="va">my_est</span>,  continuous<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<p>From this discrete inference one can map either the region-specific incidence or the covariate adjusted relative risk.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#to map the incidence</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">Dis_pred</span>, type<span class="op">=</span><span class="st">"incidence"</span>, continuous <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="co">#and its standard error</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">Dis_pred</span>, type<span class="op">=</span><span class="st">"SDincidence"</span>, continuous <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="co">#to map the covariate adjusted relative risk</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">Dis_pred</span>, type<span class="op">=</span><span class="st">"CovAdjRelRisk"</span>, continuous <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="co">#and its standard error</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">Dis_pred</span>, type<span class="op">=</span><span class="st">"SDCovAdjRelRisk"</span>, continuous <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="co">#to map the exceedance probability that the covariate-adjusted relative risk is greter than a particular threshold</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">Dis_pred</span>, type<span class="op">=</span><span class="st">"CovAdjRelRisk"</span>, continuous <span class="op">=</span> <span class="cn">FALSE</span>, thresholds<span class="op">=</span><span class="fl">3.0</span><span class="op">)</span></span></code></pre></div>
<ol style="list-style-type: decimal">
<li>If interested in spatially continuous prediction of the covariate adjusted relative risk. This is achieved by simply setting in the function.</li>
</ol>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Con_pred</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/SDALGCPPred.html">SDALGCPPred</a></span><span class="op">(</span>para_est<span class="op">=</span><span class="va">my_est</span>, cellsize<span class="op">=</span><span class="fl">300</span>, continuous<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p>Then we map the spatially continuous covariate adjusted relative risk.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#to map the covariate adjusted relative risk</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">Con_pred</span>, type<span class="op">=</span><span class="st">"relrisk"</span><span class="op">)</span></span>
<span><span class="co">#and its standard error</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">Con_pred</span>, type<span class="op">=</span><span class="st">"SErelrisk"</span><span class="op">)</span></span>
<span><span class="co">#to map the exceedance probability that the relative risk is greter than a particular threshold</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">Dis_pred</span>, type<span class="op">=</span><span class="st">"relrisk"</span>, thresholds<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="sdalgcp-ii-unweighted">SDALGCP II (Unweighted)<a class="anchor" aria-label="anchor" href="#sdalgcp-ii-unweighted"></a>
</h2>
<p>As for the unweighted which is typically by taking the simple average of the intensity an LGCP model, the entire code in the weighted can be used by just setting in the line below.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">my_est</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/SDALGCPMCML.html">SDALGCPMCML</a></span><span class="op">(</span>data<span class="op">=</span><span class="va">data</span>, formula<span class="op">=</span><span class="va">FORM</span>, my_shp<span class="op">=</span><span class="va">PBCshp</span>, delta<span class="op">=</span><span class="fl">300</span>, phi<span class="op">=</span><span class="va">phi</span>, method<span class="op">=</span><span class="fl">1</span>, </span>
<span>                      weighted<span class="op">=</span><span class="cn">FALSE</span>, par0<span class="op">=</span><span class="cn">NULL</span>, control.mcmc<span class="op">=</span><span class="cn">NULL</span>, messages <span class="op">=</span> <span class="cn">TRUE</span>, plot_profile <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level1">
<h1 id="spatio-temporal-sdalgcp">Spatio-temporal SDALGCP<a class="anchor" aria-label="anchor" href="#spatio-temporal-sdalgcp"></a>
</h1>
<p>Download the dataset</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">require</a></span><span class="op">(</span><span class="va">rgdal</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">require</a></span><span class="op">(</span><span class="va"><a href="https://github.com/edzer/sp/" class="external-link">sp</a></span><span class="op">)</span></span>
<span><span class="va">ohiorespMort</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.csv</a></span><span class="op">(</span><span class="st">"https://raw.githubusercontent.com/olatunjijohnson/dataset/master/OhioRespMort.csv"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/download.file.html" class="external-link">download.file</a></span><span class="op">(</span><span class="st">"https://github.com/olatunjijohnson/dataset/raw/master/ohio_shapefile.zip"</span>, <span class="st">"ohio_shapefile.zip"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/unzip.html" class="external-link">unzip</a></span><span class="op">(</span><span class="st">"ohio_shapefile.zip"</span><span class="op">)</span></span>
<span><span class="va">ohio_shp</span> <span class="op">&lt;-</span> <span class="fu">rgdal</span><span class="fu">::</span><span class="fu">readOGR</span><span class="op">(</span><span class="st">"ohio_shapefile/"</span>,<span class="st">"tl_2010_39_county00"</span><span class="op">)</span></span>
<span><span class="co"># and for windows use ohio_shp &lt;- rgdal::readOGR("ohio_shapefile","tl_2010_39_county00")</span></span>
<span><span class="va">ohio_shp</span> <span class="op">&lt;-</span> <span class="fu">sp</span><span class="fu">::</span><span class="fu"><a href="https://edzer.github.io/sp/reference/spTransform.html" class="external-link">spTransform</a></span><span class="op">(</span><span class="va">ohio_shp</span>, <span class="fu">sp</span><span class="fu">::</span><span class="fu"><a href="https://edzer.github.io/sp/reference/CRS-class.html" class="external-link">CRS</a></span><span class="op">(</span><span class="st">"+init=epsg:32617"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>create a spacetime object as an input of the spatio-temporal SDALGCP model</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">m</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">ohio_shp</span><span class="op">)</span></span>
<span><span class="va">TT</span> <span class="op">&lt;-</span> <span class="fl">21</span></span>
<span><span class="va">Y</span> <span class="op">&lt;-</span> <span class="va">ohiorespMort</span><span class="op">$</span><span class="va">y</span></span>
<span><span class="va">X</span> <span class="op">&lt;-</span> <span class="va">ohiorespMort</span><span class="op">$</span><span class="va">year</span></span>
<span><span class="va">pop</span> <span class="op">&lt;-</span> <span class="va">ohiorespMort</span><span class="op">$</span><span class="va">n</span></span>
<span><span class="va">E</span> <span class="op">&lt;-</span> <span class="va">ohiorespMort</span><span class="op">$</span><span class="va">E</span></span>
<span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>Y<span class="op">=</span><span class="va">Y</span>, X<span class="op">=</span><span class="va">X</span>, pop<span class="op">=</span><span class="va">pop</span>, E<span class="op">=</span><span class="va">E</span><span class="op">)</span></span>
<span><span class="va">formula</span> <span class="op">&lt;-</span> <span class="va">Y</span> <span class="op">~</span>  <span class="va">X</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/offset.html" class="external-link">offset</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">E</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">phi</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fl">300</span>, length.out <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span>
<span><span class="va">control.mcmc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>n.sim<span class="op">=</span><span class="fl">10000</span>, burnin<span class="op">=</span><span class="fl">2000</span>, thin<span class="op">=</span><span class="fl">80</span>, h<span class="op">=</span><span class="fl">1.65</span><span class="op">/</span><span class="op">(</span><span class="op">(</span><span class="va">m</span><span class="op">*</span><span class="va">TT</span><span class="op">)</span><span class="op">^</span><span class="op">(</span><span class="fl">1</span><span class="op">/</span><span class="fl">6</span><span class="op">)</span><span class="op">)</span>, c1.h<span class="op">=</span><span class="fl">0.01</span>, c2.h<span class="op">=</span><span class="fl">0.0001</span><span class="op">)</span></span>
<span><span class="va">time</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.POSIXlt.html" class="external-link">as.POSIXct</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="fl">1968</span><span class="op">:</span><span class="fl">1988</span>, <span class="st">"-01-01"</span>, sep <span class="op">=</span> <span class="st">""</span><span class="op">)</span>, tz <span class="op">=</span> <span class="st">""</span><span class="op">)</span></span>
<span><span class="va">st_data</span> <span class="op">&lt;-</span> <span class="fu">spacetime</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/spacetime/man/STFDF-class.html" class="external-link">STFDF</a></span><span class="op">(</span>sp <span class="op">=</span> <span class="va">ohio_shp</span>, time <span class="op">=</span> <span class="va">time</span>, data <span class="op">=</span> <span class="va">data</span><span class="op">)</span></span></code></pre></div>
<p>Plot the spatio-temporal count data</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">spacetime</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/spacetime/man/stplot.html" class="external-link">stplot</a></span><span class="op">(</span><span class="va">st_data</span><span class="op">[</span>,,<span class="st">"Y"</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
<p>Parameter estimation</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">model.fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/SDALGCPMCML_ST.html">SDALGCPMCML_ST</a></span><span class="op">(</span>formula<span class="op">=</span><span class="va">formula</span>, st_data <span class="op">=</span> <span class="va">st_data</span>,  delta<span class="op">=</span><span class="fl">800</span>, </span>
<span>                            phi<span class="op">=</span><span class="va">phi</span>, method<span class="op">=</span><span class="fl">2</span>, pop_shp<span class="op">=</span><span class="cn">NULL</span>,  kappa<span class="op">=</span><span class="fl">0.5</span>,</span>
<span>                            weighted<span class="op">=</span><span class="cn">FALSE</span>, par0<span class="op">=</span><span class="cn">NULL</span>, control.mcmc<span class="op">=</span><span class="va">control.mcmc</span>, </span>
<span>                            plot<span class="op">=</span><span class="cn">TRUE</span>, plot_profile<span class="op">=</span><span class="cn">TRUE</span>, rho<span class="op">=</span><span class="cn">NULL</span>,</span>
<span>                            giveup<span class="op">=</span><span class="fl">50</span>, messages<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">model.fit</span><span class="op">)</span></span></code></pre></div>
<p>Area-level of the spatio-temporal prediction</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dis_pred</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/SDALGCPPred_ST.html">SDALGCPPred_ST</a></span><span class="op">(</span>para_est <span class="op">=</span> <span class="va">model.fit</span>, continuous <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<p>Ploting the area-level incidence and the covariate adjusted relative risk</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">dis_pred</span>, type<span class="op">=</span><span class="st">"CovAdjRelRisk"</span>, main<span class="op">=</span><span class="st">"Relative Risk"</span>, continuous<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">dis_pred</span>,  type<span class="op">=</span><span class="st">"incidence"</span>, main<span class="op">=</span><span class="st">"Incidence"</span>, continuous<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<p>Spatially continuous prediction of the covariate adjusted relative risk</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">con_pred</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/SDALGCPPred_ST.html">SDALGCPPred_ST</a></span><span class="op">(</span>para_est <span class="op">=</span> <span class="va">model.fit</span>, cellsize <span class="op">=</span> <span class="fl">2500</span>, continuous<span class="op">=</span><span class="cn">TRUE</span>, n.window <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<p>Ploting the spatially continuous covariate-adjusted relative risk</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">con_pred</span>, type<span class="op">=</span><span class="st">"relrisk"</span>, continuous<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
</div>

  </main><aside class="col-md-3"><div class="links">
<h2 data-toc-skip>Links</h2>
<ul class="list-unstyled">
<li><a href="https://cloud.r-project.org/package=SDALGCP" class="external-link">View on CRAN</a></li>
<li><a href="https://github.com/olatunjijohnson/SDALGCP/" class="external-link">Browse source code</a></li>
<li><a href="https://github.com/olatunjijohnson/SDALGCP/issues" class="external-link">Report a bug</a></li>
</ul>
</div>

<div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li>
<a href="https://www.r-project.org/Licenses/GPL-2" class="external-link">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3" class="external-link">GPL-3</a>
</li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing SDALGCP</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Olatunji Johnson <br><small class="roles"> Author, maintainer </small>   </li>
<li>Emanuele Giorgi <br><small class="roles"> Author </small>   </li>
<li>Peter Diggle <br><small class="roles"> Author </small>   </li>
</ul>
</div>



  </aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Olatunji Johnson, Emanuele Giorgi, Peter Diggle.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
