<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>A Spatially Discrete Approximation to Log-Gaussian Cox Processes for Modelling Aggregated Disease Count Data ‚Ä¢ SDALGCP</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="A Spatially Discrete Approximation to Log-Gaussian Cox Processes for Modelling Aggregated Disease Count Data">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">SDALGCP</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.5.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/SDALGCP-vignette.html">A Spatially Discrete Approximation to Log-Gaussian Cox Processes for Modelling Aggregated Disease Count Data</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/olatunjijohnson/SDALGCP/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>A Spatially Discrete Approximation to Log-Gaussian Cox Processes for Modelling Aggregated Disease Count Data</h1>
                        <h4 data-toc-skip class="author">Olatunji
Johnson</h4>
            
            <h4 data-toc-skip class="date">2025-11-18</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/olatunjijohnson/SDALGCP/blob/master/vignettes/SDALGCP-vignette.Rmd" class="external-link"><code>vignettes/SDALGCP-vignette.Rmd</code></a></small>
      <div class="d-none name"><code>SDALGCP-vignette.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>This article presents a simple tutorial code from SDALGCP package to
make inference on spatially aggregated disease count data when one
assume that the disease risk is spatially continious. There are two main
functions provided by the package, for parameter estimation and for
prediction.</p>
<div class="section level3">
<h3 id="model">Model<a class="anchor" aria-label="anchor" href="#model"></a>
</h3>
<p>Our goal is to analyse of diease count data, more specifically when
disease cases are aggregated over a partition, say
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>‚Ñõ</mi><mn>1</mn></msub><mo>,</mo><mi>‚Ä¶</mi><mo>,</mo><msub><mi>‚Ñõ</mi><mi>n</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">(\mathcal{R}_{1}, \ldots, \mathcal{R}_{n})</annotation></semantics></math>,
of the area of interest,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>A</mi><annotation encoding="application/x-tex">A</annotation></semantics></math>,
which can be written mathematically as
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable><mtr><mtd columnalign="right" style="text-align: right"><mi>ùíü</mi><mo>=</mo><mrow><mo stretchy="true" form="prefix">{</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>y</mi><mi>i</mi></msub><mo>,</mo><msub><mi>d</mi><mi>i</mi></msub><mo>,</mo><msub><mi>‚Ñõ</mi><mi>i</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>:</mo><mi>i</mi><mo>=</mo><mn>1</mn><mo>,</mo><mi>‚Ä¶</mi><mo>,</mo><mi>n</mi><mo stretchy="true" form="postfix">}</mo></mrow></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{eqnarray}
\label{eq:data}
\mathcal{D} = \left\{(y_{i}, d_{i}, \mathcal{R}_{i}):  i=1,\ldots,n\right\}
\end{eqnarray}</annotation></semantics></math> where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>y</mi><mi>i</mi></msub><annotation encoding="application/x-tex">y_{i}</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>d</mi><mi>i</mi></msub><annotation encoding="application/x-tex">d_{i}</annotation></semantics></math>
are the number of reported cases and a vector of explanatory variables
associated with
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>i</mi><annotation encoding="application/x-tex">i</annotation></semantics></math>-th
region
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>‚Ñõ</mi><mi>i</mi></msub><annotation encoding="application/x-tex">\mathcal{R}_{i}</annotation></semantics></math>,
respectively. Hence, we model
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>y</mi><mi>i</mi></msub><annotation encoding="application/x-tex">y_{i}</annotation></semantics></math>
conditional on the stochastic process
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>X</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">S(X)</annotation></semantics></math>
as poission distribution with mean
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Œª</mi><mi>i</mi></msub><mo>=</mo><msub><mi>m</mi><mi>i</mi></msub><mo>exp</mo><mo stretchy="false" form="prefix">{</mo><msub><mi>d</mi><mi>i</mi></msub><msup><mi>Œ≤</mi><mo>*</mo></msup><mo>+</mo><msubsup><mi>S</mi><mi>i</mi><mo>*</mo></msubsup><mo stretchy="false" form="postfix">}</mo></mrow><annotation encoding="application/x-tex">\lambda_i= m_{i} \exp\{d_{i}\beta^* + S_{i}^*\}</annotation></semantics></math>.
Then we assume that
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>S</mi><mo>*</mo></msup><mo>‚àº</mo><mi>M</mi><mi>V</mi><mi>N</mi><mrow><mo stretchy="true" form="prefix">(</mo><mn>0</mn><mo>,</mo><mi>Œ£</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">S^* \sim MVN(0, \Sigma)</annotation></semantics></math>,
where
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Œ£</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>=</mo><msup><mi>œÉ</mi><mn>2</mn></msup><msub><mo>‚à´</mo><msub><mi>‚Ñõ</mi><mi>i</mi></msub></msub><msub><mo>‚à´</mo><msub><mi>‚Ñõ</mi><mi>j</mi></msub></msub><msub><mi>w</mi><mi>i</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>x</mi><mo stretchy="true" form="postfix">)</mo></mrow><msub><mi>w</mi><mi>j</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>x</mi><mi>‚Ä≤</mi><mo stretchy="true" form="postfix">)</mo></mrow><mspace width="0.222em"></mspace><mi>œÅ</mi><mrow><mo stretchy="true" form="prefix">(</mo><mo stretchy="false" form="postfix">‚à•</mo><mi>x</mi><mo>‚àí</mo><mi>x</mi><mi>‚Ä≤</mi><mo stretchy="false" form="postfix">‚à•</mo><mo>;</mo><mi>œï</mi><mo stretchy="true" form="postfix">)</mo></mrow><mspace width="0.222em"></mspace><mi>d</mi><mi>x</mi><mspace width="0.222em"></mspace><mi>d</mi><mi>x</mi><mi>‚Ä≤</mi></mrow><annotation encoding="application/x-tex">\Sigma_{ij} = \sigma^2 \int_{\mathcal{R}_{i}} \int_{\mathcal{R}_{j}} w_i(x) w_j(x') \: \rho(\|x-x'\|; \phi) \:  dx \: dx'</annotation></semantics></math>,
where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>w</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>x</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">w(x)</annotation></semantics></math>
is population density weight. There are two classes of models in this
package; one is when we approximate
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>S</mi><mi>i</mi><mo>*</mo></msubsup><mo>=</mo><msub><mo>‚à´</mo><msub><mi>‚Ñõ</mi><mi>i</mi></msub></msub><msub><mi>w</mi><mi>i</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>x</mi><mo stretchy="true" form="postfix">)</mo></mrow><msup><mi>S</mi><mo>*</mo></msup><mrow><mo stretchy="true" form="prefix">(</mo><mi>x</mi><mo stretchy="true" form="postfix">)</mo></mrow><mspace width="0.222em"></mspace><mi>d</mi><mi>x</mi></mrow><annotation encoding="application/x-tex">S_i^* = \int_{\mathcal{R}_{i}} w_i(x) S^*(x) \:  dx </annotation></semantics></math>
and the other is
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>S</mi><mi>i</mi><mo>*</mo></msubsup><mo>=</mo><mfrac><mn>1</mn><msub><mi>‚Ñõ</mi><mi>i</mi></msub></mfrac><msub><mo>‚à´</mo><msub><mi>‚Ñõ</mi><mi>i</mi></msub></msub><msup><mi>S</mi><mo>*</mo></msup><mrow><mo stretchy="true" form="prefix">(</mo><mi>x</mi><mo stretchy="true" form="postfix">)</mo></mrow><mspace width="0.222em"></mspace><mi>d</mi><mi>x</mi><mi>.</mi></mrow><annotation encoding="application/x-tex">S_i^* = \frac{1}{\mathcal{R}_{i}} \int_{\mathcal{R}_{i}} S^*(x) \:  dx. </annotation></semantics></math>
## Inference We used Monte Carlo Maximum Likelihood for inference. The
likelihood function for this class of model is usually intractible,
hence we approximate the likelihood function as
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mfrac><mn>1</mn><mi>N</mi></mfrac><mspace width="0.222em"></mspace><munderover><mo>‚àë</mo><mrow><mi>j</mi><mo>=</mo><mn>1</mn></mrow><mi>N</mi></munderover><mspace width="0.222em"></mspace><mfrac><mrow><mi>f</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>Œ∑</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>j</mi><mo stretchy="true" form="postfix">)</mo></mrow></msub><mo>;</mo><mi>œà</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><mrow><mi>f</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>Œ∑</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>j</mi><mo stretchy="true" form="postfix">)</mo></mrow></msub><mo>;</mo><msub><mi>œà</mi><mn>0</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow></mfrac><mi>.</mi></mrow><annotation encoding="application/x-tex">\frac{1}{N}~ \sum_{j=1}^N~\frac{f(\eta_{(j)}; \psi)}{f(\eta_{(j)}; \psi_0)}.</annotation></semantics></math>,
where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>œà</mi><annotation encoding="application/x-tex">\psi</annotation></semantics></math>
is the vector of the parameters.</p>
<p>This vignette walk you through how to analyse spatial and
spatio-temporal dataset using package. Two illustrative examples were
provided; application to primary biliary cirrhosis in
Newcastle-upon-tyne, UK (static spatial case) and Lung cancer mortality
in Ohio, USA (spatio-temporal case).</p>
</div>
</div>
<div class="section level2">
<h2 id="tutorial">Tutorial<a class="anchor" aria-label="anchor" href="#tutorial"></a>
</h2>
<p>This part illustrates how to fit an SDALGCP model to spatially
aggregated data. We used the example dataset that is supplied in the
package.</p>
<p>load the package</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">require</a></span><span class="op">(</span><span class="va"><a href="https://github.com/olatunjijohnson/SDALGCP" class="external-link">SDALGCP</a></span><span class="op">)</span></span></code></pre></div>
<p>load the data</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"PBCshp"</span><span class="op">)</span></span></code></pre></div>
<p>extract the dataframe containing data from the object loaded</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="va">PBCshp</span><span class="op">@</span><span class="va">data</span><span class="op">)</span></span></code></pre></div>
<p>load the population density raster</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"pop_den"</span><span class="op">)</span></span></code></pre></div>
<p>set any population density that is NA to zero</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pop_den</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">pop_den</span><span class="op">[</span><span class="op">]</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">0</span></span></code></pre></div>
<p>write a formula of the model you want to fit</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">FORM</span> <span class="op">&lt;-</span> <span class="va">X</span> <span class="op">~</span> <span class="va">propmale</span> <span class="op">+</span> <span class="va">Income</span> <span class="op">+</span> <span class="va">Employment</span> <span class="op">+</span> <span class="va">Education</span> <span class="op">+</span> <span class="va">Barriers</span> <span class="op">+</span> <span class="va">Crime</span> <span class="op">+</span> </span>
<span>  <span class="va">Environment</span> <span class="op">+</span>  <span class="fu"><a href="https://rdrr.io/r/stats/offset.html" class="external-link">offset</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">pop</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>Now to proceed to fitting the model, note that there two types of
model that can be fitted. One is when approximate the intensity of LGCP
by taking the population weighted average and the other is by taking the
simple average. We shall consider both cases in this tutorial, starting
with population weighted since we have population density on a raster
grid of 300m by 300m.</p>
<div class="section level3">
<h3 id="sdalgcp-i-population-weighted-application-to-primary-biliary-cirrhosis-in-newcastle-upon-tyne-uk">SDALGCP I (population weighted): application to primary biliary
cirrhosis in Newcastle-upon-tyne, UK<a class="anchor" aria-label="anchor" href="#sdalgcp-i-population-weighted-application-to-primary-biliary-cirrhosis-in-newcastle-upon-tyne-uk"></a>
</h3>
<p>Here we estimate the parameters of the model</p>
<p>Discretise the value of scale parameter
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>œï</mi><annotation encoding="application/x-tex">\phi</annotation></semantics></math></p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">phi</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">500</span>, <span class="fl">1700</span>, length.out <span class="op">=</span> <span class="fl">20</span><span class="op">)</span></span></code></pre></div>
<p>estimate the parameter using MCML</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">my_est</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/SDALGCPMCML.html">SDALGCPMCML</a></span><span class="op">(</span>data<span class="op">=</span><span class="va">data</span>, formula<span class="op">=</span><span class="va">FORM</span>, my_shp<span class="op">=</span><span class="va">PBCshp</span>, delta<span class="op">=</span><span class="fl">200</span>, phi<span class="op">=</span><span class="va">phi</span>, method<span class="op">=</span><span class="fl">1</span>, pop_shp<span class="op">=</span><span class="va">pop_den</span>, </span>
<span>                      weighted<span class="op">=</span><span class="cn">TRUE</span>, par0<span class="op">=</span><span class="cn">NULL</span>, control.mcmc<span class="op">=</span><span class="cn">NULL</span><span class="op">)</span></span></code></pre></div>
<p>To print the summary of the parameter estimates as well as the
confidence interval, use;</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">my_est</span><span class="op">)</span></span>
<span><span class="co">#and for confidence interval use</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/confint.html" class="external-link">confint</a></span><span class="op">(</span><span class="va">my_est</span><span class="op">)</span></span></code></pre></div>
<p>We create a function to compute the confidence interval of the scale
parameter using the deviance method. It also provides the deviance
plot.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/phiCI.html">phiCI</a></span><span class="op">(</span><span class="va">my_est</span>, coverage <span class="op">=</span> <span class="fl">0.95</span>, plot <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p>Having estimated the parameters of the model, one might be interested
in area-level inference or spatially continuous inference.</p>
<ol style="list-style-type: decimal">
<li>If interested in STRICTLY area-level inference use the code below.
This can either give either region-specific covariate-adjusted relative
risk or region-specific incidence. This is achieved by simply setting in
the function.</li>
</ol>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Dis_pred</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/SDALGCPPred.html">SDALGCPPred</a></span><span class="op">(</span>para_est<span class="op">=</span><span class="va">my_est</span>,  continuous<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<p>From this discrete inference one can map either the region-specific
incidence or the covariate adjusted relative risk.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#to map the incidence</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">Dis_pred</span>, type<span class="op">=</span><span class="st">"incidence"</span>, continuous <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="co">#and its standard error</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">Dis_pred</span>, type<span class="op">=</span><span class="st">"SEincidence"</span>, continuous <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="co">#to map the covariate adjusted relative risk</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">Dis_pred</span>, type<span class="op">=</span><span class="st">"CovAdjRelRisk"</span>, continuous <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="co">#and its standard error</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">Dis_pred</span>, type<span class="op">=</span><span class="st">"SECovAdjRelRisk"</span>, continuous <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="co">#to map the exceedance probability that the covariate-adjusted relative risk is greter than a particular threshold</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">Dis_pred</span>, type<span class="op">=</span><span class="st">"CovAdjRelRisk"</span>, continuous <span class="op">=</span> <span class="cn">FALSE</span>, thresholds<span class="op">=</span><span class="fl">3.0</span><span class="op">)</span></span></code></pre></div>
<ol start="2" style="list-style-type: decimal">
<li>If interested in spatially continuous prediction of the covariate
adjusted relative risk. This is achieved by simply setting in the
function.</li>
</ol>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Con_pred</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/SDALGCPPred.html">SDALGCPPred</a></span><span class="op">(</span>para_est<span class="op">=</span><span class="va">my_est</span>, cellsize <span class="op">=</span> <span class="fl">300</span>, continuous<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p>Then we map the spatially continuous covariate adjusted relative
risk.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#to map the covariate adjusted relative risk</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">Con_pred</span>, type<span class="op">=</span><span class="st">"relrisk"</span><span class="op">)</span></span>
<span><span class="co">#and its standard error</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">Con_pred</span>, type<span class="op">=</span><span class="st">"SErelrisk"</span><span class="op">)</span></span>
<span><span class="co">#to map the exceedance probability that the relative risk is greter than a particular threshold</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">Con_pred</span>, type<span class="op">=</span><span class="st">"relrisk"</span>, thresholds<span class="op">=</span><span class="fl">1.5</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="sdalgcp-ii-unweighted">SDALGCP II (Unweighted)<a class="anchor" aria-label="anchor" href="#sdalgcp-ii-unweighted"></a>
</h3>
<p>As for the unweighted which is typically by taking the simple average
of the intensity an LGCP model, the entire code in the weighted can be
used by just setting in the line below.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">my_est</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/SDALGCPMCML.html">SDALGCPMCML</a></span><span class="op">(</span>data<span class="op">=</span><span class="va">data</span>, formula<span class="op">=</span><span class="va">FORM</span>, my_shp<span class="op">=</span><span class="va">PBCshp</span>, delta<span class="op">=</span><span class="fl">200</span>, phi<span class="op">=</span><span class="va">phi</span>, method<span class="op">=</span><span class="fl">1</span>, </span>
<span>                      weighted<span class="op">=</span><span class="cn">FALSE</span>,  plot<span class="op">=</span><span class="cn">FALSE</span>, par0<span class="op">=</span><span class="cn">NULL</span>, control.mcmc<span class="op">=</span><span class="cn">NULL</span>, messages <span class="op">=</span> <span class="cn">TRUE</span>, plot_profile <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="spatio-temporal-sdalgcp-application-to-lung-cancer-mortality-in-ohio-">Spatio-temporal SDALGCP: application to Lung cancer mortality in
Ohio.<a class="anchor" aria-label="anchor" href="#spatio-temporal-sdalgcp-application-to-lung-cancer-mortality-in-ohio-"></a>
</h2>
<p>Download the dataset</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">require</a></span><span class="op">(</span><span class="va">rgdal</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">require</a></span><span class="op">(</span><span class="va"><a href="https://github.com/edzer/sp/" class="external-link">sp</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">require</a></span><span class="op">(</span><span class="va"><a href="https://github.com/edzer/spacetime" class="external-link">spacetime</a></span><span class="op">)</span></span>
<span><span class="va">ohiorespMort</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.csv</a></span><span class="op">(</span><span class="st">"https://raw.githubusercontent.com/olatunjijohnson/dataset/master/OhioRespMort.csv"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/download.file.html" class="external-link">download.file</a></span><span class="op">(</span><span class="st">"https://github.com/olatunjijohnson/dataset/raw/master/ohio_shapefile.zip"</span>, <span class="st">"ohio_shapefile.zip"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/unzip.html" class="external-link">unzip</a></span><span class="op">(</span><span class="st">"ohio_shapefile.zip"</span><span class="op">)</span></span>
<span><span class="va">ohio_shp</span> <span class="op">&lt;-</span> <span class="fu">rgdal</span><span class="fu">::</span><span class="fu">readOGR</span><span class="op">(</span><span class="st">"ohio_shapefile/"</span>,<span class="st">"tl_2010_39_county00"</span><span class="op">)</span></span>
<span><span class="va">ohio_shp</span> <span class="op">&lt;-</span> <span class="fu">sp</span><span class="fu">::</span><span class="fu"><a href="https://edzer.github.io/sp/reference/spTransform.html" class="external-link">spTransform</a></span><span class="op">(</span><span class="va">ohio_shp</span>, <span class="fu">sp</span><span class="fu">::</span><span class="fu"><a href="https://edzer.github.io/sp/reference/CRS-class.html" class="external-link">CRS</a></span><span class="op">(</span><span class="st">"+init=epsg:32617"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>create a spacetime object as an input of the spatio-temporal SDALGCP
model</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">m</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">ohio_shp</span><span class="op">)</span></span>
<span><span class="va">TT</span> <span class="op">&lt;-</span> <span class="fl">21</span></span>
<span><span class="va">Y</span> <span class="op">&lt;-</span> <span class="va">ohiorespMort</span><span class="op">$</span><span class="va">y</span></span>
<span><span class="va">X</span> <span class="op">&lt;-</span> <span class="va">ohiorespMort</span><span class="op">$</span><span class="va">year</span></span>
<span><span class="va">pop</span> <span class="op">&lt;-</span> <span class="va">ohiorespMort</span><span class="op">$</span><span class="va">n</span></span>
<span><span class="va">E</span> <span class="op">&lt;-</span> <span class="va">ohiorespMort</span><span class="op">$</span><span class="va">E</span></span>
<span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>Y<span class="op">=</span><span class="va">Y</span>, X<span class="op">=</span><span class="va">X</span>, pop<span class="op">=</span><span class="va">pop</span>, E<span class="op">=</span><span class="va">E</span><span class="op">)</span></span>
<span><span class="va">formula</span> <span class="op">&lt;-</span> <span class="va">Y</span> <span class="op">~</span>  <span class="va">X</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/offset.html" class="external-link">offset</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">E</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">phi</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fl">300</span>, length.out <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span>
<span><span class="va">control.mcmc</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/controlmcmcSDA.html">controlmcmcSDA</a></span><span class="op">(</span>n.sim<span class="op">=</span><span class="fl">10000</span>, burnin<span class="op">=</span><span class="fl">2000</span>, thin<span class="op">=</span><span class="fl">80</span>, h<span class="op">=</span><span class="fl">1.65</span><span class="op">/</span><span class="op">(</span><span class="op">(</span><span class="va">m</span><span class="op">*</span><span class="va">TT</span><span class="op">)</span><span class="op">^</span><span class="op">(</span><span class="fl">1</span><span class="op">/</span><span class="fl">6</span><span class="op">)</span><span class="op">)</span>, c1.h<span class="op">=</span><span class="fl">0.01</span>, c2.h<span class="op">=</span><span class="fl">0.0001</span><span class="op">)</span></span>
<span><span class="va">time</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.POSIXlt.html" class="external-link">as.POSIXct</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="fl">1968</span><span class="op">:</span><span class="fl">1988</span>, <span class="st">"-01-01"</span>, sep <span class="op">=</span> <span class="st">""</span><span class="op">)</span>, tz <span class="op">=</span> <span class="st">""</span><span class="op">)</span></span>
<span><span class="va">st_data</span> <span class="op">&lt;-</span> <span class="fu">spacetime</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/spacetime/man/STFDF-class.html" class="external-link">STFDF</a></span><span class="op">(</span>sp <span class="op">=</span> <span class="va">ohio_shp</span>, time <span class="op">=</span> <span class="va">time</span>, data <span class="op">=</span> <span class="va">data</span><span class="op">)</span></span></code></pre></div>
<p>Plot the spatio-temporal count data</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">spacetime</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/spacetime/man/stplot.html" class="external-link">stplot</a></span><span class="op">(</span><span class="va">st_data</span><span class="op">[</span>,,<span class="st">"Y"</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
<p>Parameter estimation</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">model.fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/SDALGCPMCML_ST.html">SDALGCPMCML_ST</a></span><span class="op">(</span>formula<span class="op">=</span><span class="va">formula</span>, st_data <span class="op">=</span> <span class="va">st_data</span>,  delta<span class="op">=</span><span class="fl">800</span>, </span>
<span>                            phi<span class="op">=</span><span class="va">phi</span>, method<span class="op">=</span><span class="fl">2</span>, pop_shp<span class="op">=</span><span class="cn">NULL</span>,  kappa<span class="op">=</span><span class="fl">0.5</span>,</span>
<span>                            weighted<span class="op">=</span><span class="cn">FALSE</span>, par0<span class="op">=</span><span class="cn">NULL</span>, control.mcmc<span class="op">=</span><span class="va">control.mcmc</span>, </span>
<span>                            plot<span class="op">=</span><span class="cn">TRUE</span>, plot_profile<span class="op">=</span><span class="cn">TRUE</span>, rho<span class="op">=</span><span class="cn">NULL</span>,</span>
<span>                            giveup<span class="op">=</span><span class="fl">50</span>, messages<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">model.fit</span><span class="op">)</span></span></code></pre></div>
<p>Area-level of the spatio-temporal prediction</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dis_pred</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/SDALGCPPred_ST.html">SDALGCPPred_ST</a></span><span class="op">(</span>para_est <span class="op">=</span> <span class="va">model.fit</span>, continuous <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<p>Ploting the area-level incidence and the covariate adjusted relative
risk</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">dis_pred</span>, type<span class="op">=</span><span class="st">"CovAdjRelRisk"</span>, main<span class="op">=</span><span class="st">"Relative Risk"</span>, continuous<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">dis_pred</span>,  type<span class="op">=</span><span class="st">"incidence"</span>, main<span class="op">=</span><span class="st">"Incidence"</span>, continuous<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<p>Spatially continuous prediction of the covariate adjusted relative
risk</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">con_pred</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/SDALGCPPred_ST.html">SDALGCPPred_ST</a></span><span class="op">(</span>para_est <span class="op">=</span> <span class="va">model.fit</span>, cellsize <span class="op">=</span> <span class="fl">2500</span>, continuous<span class="op">=</span><span class="cn">TRUE</span>, n.window <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<p>Ploting the spatially continuous covariate-adjusted relative risk</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">con_pred</span>, type<span class="op">=</span><span class="st">"relrisk"</span>, continuous<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p>#Discussion Using SDALGCP package for analysis of spatially
aggregated data provides two main advantages. One, it allows the user to
make spatially continous inference irrespective of the level of
aggregation of the data. Second, it is more computationally efficient
than the lgcp model for aggregated data that was implemented in
package.</p>
<!-- Vignettes are long form documentation commonly included in packages. Because they are part of the distribution of the package, they need to be as compact as possible. The `html_vignette` output type provides a custom style sheet (and tweaks some options) to ensure that the resulting html is as small as possible. The `html_vignette` format: -->
<!-- - Never uses retina figures -->
<!-- - Has a smaller default figure size -->
<!-- - Uses a custom CSS stylesheet instead of the default Twitter Bootstrap style -->
<!-- ## Vignette Info -->
<!-- Note the various macros within the `vignette` section of the metadata block above. These are required in order to instruct R how to build the vignette. Note that you should change the `title` field and the `\VignetteIndexEntry` to match the title of your vignette. -->
<!-- ## Styles -->
<!-- The `html_vignette` template includes a basic CSS theme. To override this theme you can specify your own CSS in the document metadata as follows: -->
<!--     output:  -->
<!--       rmarkdown::html_vignette: -->
<!--         css: mystyles.css -->
<!-- ## Figures -->
<!-- The figure sizes have been customised so that you can easily put two images side-by-side.  -->
<!-- ```{r, fig.show='hold'} -->
<!-- plot(1:10) -->
<!-- plot(10:1) -->
<!-- ``` -->
<!-- You can enable figure captions by `fig_caption: yes` in YAML: -->
<!--     output: -->
<!--       rmarkdown::html_vignette: -->
<!--         fig_caption: yes -->
<!-- Then you can use the chunk option `fig.cap = "Your figure caption."` in **knitr**. -->
<!-- ## More Examples -->
<!-- You can write math expressions, e.g. $Y = X\beta + \epsilon$, footnotes^[A footnote here.], and tables, e.g. using `knitr::kable()`. -->
<!-- ```{r, echo=FALSE, results='asis'} -->
<!-- knitr::kable(head(mtcars, 10)) -->
<!-- ``` -->
<!-- Also a quote using `>`: -->
<!-- > "He who gives up [code] safety for [code] speed deserves neither." -->
<!-- ([via](https://twitter.com/hadleywickham/status/504368538874703872)) -->
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Olatunji Johnson, Emanuele Giorgi, Peter Diggle.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
