% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/dm_functions.R
\name{Laplace.sampling}
\alias{Laplace.sampling}
\title{Conditional Simulation via Langevin-Hastings MCMC}
\usage{
Laplace.sampling(
  mu,
  Sigma,
  y,
  units.m,
  control.mcmc,
  ID.coords = NULL,
  messages = TRUE,
  plot.correlogram = TRUE,
  poisson.llik = FALSE
)
}
\arguments{
\item{mu}{Mean vector of the latent Gaussian process.}

\item{Sigma}{Covariance matrix of the latent Gaussian process.}

\item{y}{Vector of Poisson or Binomial observations.}

\item{units.m}{Vector of Binomial denominators or Poisson offsets.}

\item{control.mcmc}{A list returned by \code{\link{controlmcmcSDA}}, containing MCMC control parameters.}

\item{ID.coords}{Optional vector of integers specifying a mapping from observation-level data to spatial locations. Used for hierarchical data (e.g., individuals within households). Defaults to \code{NULL}.}

\item{messages}{Logical; if \code{TRUE}, print iteration updates to the console. Default is \code{TRUE}.}

\item{plot.correlogram}{Logical; if \code{TRUE}, display autocorrelation plots of the samples. Default is \code{TRUE}.}

\item{poisson.llik}{Logical; if \code{TRUE}, use Poisson likelihood. If \code{FALSE}, use Binomial. Default is \code{FALSE}.}
}
\value{
A list of class \code{"mcmc.P"} with components:
\describe{
  \item{\code{samples}}{A matrix of sampled values. Each row corresponds to a posterior sample.}
  \item{\code{h}}{A vector of tuning parameter values (one for each iteration).}
}
}
\description{
Simulates from the posterior distribution of a latent Gaussian random effect conditional on Poisson or Binomial data using a Langevin-Hastings MCMC algorithm with adaptive tuning.
}
\details{
This function implements Langevin-Hastings MCMC to sample from a high-dimensional latent Gaussian field conditional on discrete outcome data. It uses Laplace approximation for initialization and adapts the step size over time to maintain optimal acceptance rates.
}
\seealso{
\code{\link{maxim.integrand}}, \code{\link{controlmcmcSDA}}
}
