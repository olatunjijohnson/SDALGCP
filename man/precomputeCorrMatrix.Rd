% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/dm_functions.R
\name{precomputeCorrMatrix}
\alias{precomputeCorrMatrix}
\title{Precompute Correlation Matrices for Spatial Regions}
\usage{
precomputeCorrMatrix(S.coord, phi)
}
\arguments{
\item{S.coord}{A list of lists, each containing at least a matrix named \code{xy} with point coordinates. If \code{attr(S.coord, "weighted")} is \code{TRUE}, each element must also include a vector named \code{weight}.}

\item{phi}{A numeric vector of spatial scale (decay) parameters.}
}
\value{
A list containing:
\describe{
  \item{R}{An array of dimension \code{[n_regions, n_regions, length(phi)]} containing the correlation matrices.}
  \item{phi}{The input vector of spatial scale parameters.}
}
}
\description{
Computes correlation matrices between spatial regions using an exponential covariance function. This function supports both unweighted and population-weighted formulations.
}
\details{
The function uses the exponential correlation function:
\deqn{\mathrm{Corr}(d) = \exp(-d / \phi)}
where \eqn{d} is the Euclidean distance between points and \eqn{\phi} is a spatial scale parameter.

If \code{weighted = TRUE}, the function computes correlations as weighted sums using the product of weights and the exponential kernel values. Otherwise, it uses unweighted averages.
}
\keyword{internal}
