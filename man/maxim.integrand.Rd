% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/dm_functions.R
\name{maxim.integrand}
\alias{maxim.integrand}
\title{Mode and Covariance for Conditional Gaussian Random Effects}
\usage{
maxim.integrand(
  y,
  units.m,
  mu,
  Sigma,
  ID.coords = NULL,
  poisson.llik = FALSE,
  hessian = FALSE
)
}
\arguments{
\item{y}{A vector of Binomial or Poisson observations.}

\item{units.m}{A vector of Binomial denominators (for binomial model) or offset values (for Poisson model).}

\item{mu}{A numeric vector giving the mean of the latent Gaussian process.}

\item{Sigma}{Covariance matrix of the Gaussian process (must be symmetric positive-definite).}

\item{ID.coords}{Optional vector of integers indicating shared coordinates for nested data structures (e.g., individuals nested within households). If \code{NULL}, observations are assumed to be at the same resolution as \code{mu}.}

\item{poisson.llik}{Logical; if \code{TRUE}, use Poisson likelihood, otherwise Binomial.}

\item{hessian}{Logical; if \code{TRUE}, return the Hessian matrix at the mode. If \code{FALSE} (default), return the inverse of the negative Hessian (i.e., Laplace covariance matrix).}
}
\value{
A list with components:
\describe{
  \item{\code{mode}}{The conditional mode (posterior mode) of the latent Gaussian process.}
  \item{\code{Sigma.tilde}}{The covariance matrix from Laplace approximation (only returned if \code{hessian = FALSE}).}
  \item{\code{hessian}}{The Hessian matrix at the mode (only returned if \code{hessian = TRUE}).}
}
}
\description{
Computes the mode and covariance matrix of a Gaussian random effect conditional on Binomial or Poisson data, using the Laplace approximation.
}
